<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.6.40">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Stability via multiple Lyapunov functions – B(E)3M35HYS – Hybrid systems</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./stability_software.html" rel="next">
<link href="./stability_via_common_lyapunov_function.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-549806ee2085284f45b00abea8c6df48.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap-8c89492777ddc1c6ab649c9c2f2ee7ae.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>

  <script>window.backupDefine = window.define; window.define = undefined;</script><script src="https://cdn.jsdelivr.net/npm/katex@latest/dist/katex.min.js"></script>
  <script>document.addEventListener("DOMContentLoaded", function () {
 var mathElements = document.getElementsByClassName("math");
 var macros = [];
 for (var i = 0; i < mathElements.length; i++) {
  var texText = mathElements[i].firstChild;
  if (mathElements[i].tagName == "SPAN") {
   katex.render(texText.data, mathElements[i], {
    displayMode: mathElements[i].classList.contains('display'),
    throwOnError: false,
    macros: macros,
    fleqn: false
   });
}}});
  </script>
  <script>window.define = window.backupDefine; window.backupDefine = undefined;</script><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@latest/dist/katex.min.css">

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

<link rel="stylesheet" href="styles.css">
</head>

<body class="nav-sidebar docked">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./stability_recap.html">8. Stability</a></li><li class="breadcrumb-item"><a href="./stability_via_multiple_lyapunov_function.html">Stability via multiple Lyapunov functions</a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation docked overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">B(E)3M35HYS – Hybrid systems</a> 
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true">
 <span class="menu-text">0. Introduction</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./intro.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">What is a hybrid system?</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./intro_outline.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Course outline</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./intro_references.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Literature</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true">
 <span class="menu-text">1. Discrete-event systems: Automata</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./des.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Discrete-event systems</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./des_automata.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">State automata</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./des_software.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Software</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./des_references.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Literature</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="true">
 <span class="menu-text">2. Discrete-event systems: Petri nets</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./petri_nets.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Petri nets</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./petri_nets_timed.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Timed Petri nets</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./petri_nets_software.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Software</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./petri_nets_references.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Literature</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="true">
 <span class="menu-text">3. Discrete-event systems: Max-plus systems</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./max_plus_algebra.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Max-plus algebra</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./max_plus_systems.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Max-plus linear (MPL) systems</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./max_plus_software.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Software</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./max_plus_references.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Literature</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" role="navigation" aria-expanded="true">
 <span class="menu-text">4. Hybrid systems: Hybrid automata</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-5" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./hybrid_automata.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Hybrid automata</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./hybrid_automata_software.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Software</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./hybrid_automata_references.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Literature</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" role="navigation" aria-expanded="true">
 <span class="menu-text">5. Hybrid systems: Hybrid equations</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-6" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./hybrid_equations.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Hybrid equations</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./hybrid_equations_software.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Software</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./hybrid_equations_references.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Literature</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-7" role="navigation" aria-expanded="true">
 <span class="menu-text">6. Some classes of hybrid systems</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-7" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-7" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./classes_reset.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Reset systems</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./classes_switched.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Switched systems</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./classes_PWA.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Piecewise affine (PWA) systems</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./classes_software.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Software</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./classes_references.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Literature</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-8" role="navigation" aria-expanded="true">
 <span class="menu-text">7. Solution</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-8" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-8" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./solution_concepts.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Solution concepts</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./solution_types.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Types of solutions</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./solution_references.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Literature</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-9" role="navigation" aria-expanded="true">
 <span class="menu-text">8. Stability</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-9" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-9" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stability_recap.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Recap of stability analysis for continuous dynamical systems</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stability_concepts.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Stability of hybrid systems</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stability_via_common_lyapunov_function.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Stability via common Lyapunov function</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stability_via_multiple_lyapunov_function.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text">Stability via multiple Lyapunov functions</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stability_software.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Software</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stability_references.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Literature</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-10" role="navigation" aria-expanded="true">
 <span class="menu-text">9. Complementarity systems</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-10" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-10" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./complementarity_constraints.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Complementarity constraints</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./complementarity_systems.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Complementarity systems</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./complementarity_simulations.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Simulations of complementarity systems using time-stepping</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./complementarity_software.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Software</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./complementarity_references.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Literature</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-11" role="navigation" aria-expanded="true">
 <span class="menu-text">10. Mixed logical dynamical (MLD) systems</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-11" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-11" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./mld_DHA.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Discrete hybrid automata</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./mld_logic_vs_inequalities.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Logic vs mixed integer-linear inequalities</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./mld_mld_and_pwa.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Mixed logical dynamical (MLD) systems</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./mld_software.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Software</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./mld_references.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Literature</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-12" role="navigation" aria-expanded="true">
 <span class="menu-text">11. Model predictive control (MPC) for MLD systems</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-12" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-12" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./mpc_mld_online.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Online MPC for hybrid systems</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./mpc_mld_explicit.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Explicit MPC for hybrid systems</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./mpc_mld_software.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Software</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./mpc_mld_references.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Literature</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-13" role="navigation" aria-expanded="true">
 <span class="menu-text">12. Formal verification</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-13" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-13" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./verification_intro.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">What is verification?</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./verification_reachability.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Reachability analysis</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./verification_barrier.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Barrier certificates</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./verification_temporal_logics.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Temporal logics</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./verification_software.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Software</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./verification_references.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Literature</span></a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#multiple-lyapunov-function-mlf-approach-to-analysis-of-stability" id="toc-multiple-lyapunov-function-mlf-approach-to-analysis-of-stability" class="nav-link active" data-scroll-target="#multiple-lyapunov-function-mlf-approach-to-analysis-of-stability">Multiple Lyapunov Function (MLF) approach to analysis of stability</a></li>
  <li><a href="#s-procedure" id="toc-s-procedure" class="nav-link" data-scroll-target="#s-procedure">S-procedure</a>
  <ul class="collapse">
  <li><a href="#s-procedure-with-nonstrict-inequalities" id="toc-s-procedure-with-nonstrict-inequalities" class="nav-link" data-scroll-target="#s-procedure-with-nonstrict-inequalities">S-procedure with nonstrict inequalities</a></li>
  <li><a href="#sufficient-conditions" id="toc-sufficient-conditions" class="nav-link" data-scroll-target="#sufficient-conditions">Sufficient conditions</a></li>
  <li><a href="#sufficient-and-also-necessary" id="toc-sufficient-and-also-necessary" class="nav-link" data-scroll-target="#sufficient-and-also-necessary">Sufficient and also necessary</a></li>
  <li><a href="#more-on-s-procedure" id="toc-more-on-s-procedure" class="nav-link" data-scroll-target="#more-on-s-procedure">More on S-procedure</a></li>
  </ul></li>
  <li><a href="#piecewise-quadratic-lyapunov-function" id="toc-piecewise-quadratic-lyapunov-function" class="nav-link" data-scroll-target="#piecewise-quadratic-lyapunov-function">Piecewise quadratic Lyapunov function</a></li>
  <li><a href="#using-comparison-functions-and-nonstrict-inequalities" id="toc-using-comparison-functions-and-nonstrict-inequalities" class="nav-link" data-scroll-target="#using-comparison-functions-and-nonstrict-inequalities">Using comparison functions and nonstrict inequalities</a></li>
  <li><a href="#characterization-of-subsets-of-state-space-using-lmi" id="toc-characterization-of-subsets-of-state-space-using-lmi" class="nav-link" data-scroll-target="#characterization-of-subsets-of-state-space-using-lmi">Characterization of subsets of state space using LMI</a></li>
  <li><a href="#combining-the-subset-characterization-and-lyapunov-ness-using-the-s-procedure" id="toc-combining-the-subset-characterization-and-lyapunov-ness-using-the-s-procedure" class="nav-link" data-scroll-target="#combining-the-subset-characterization-and-lyapunov-ness-using-the-s-procedure">Combining the subset characterization and Lyapunov-ness using the S-procedure</a></li>
  <li><a href="#more-general-sets-using-lmi" id="toc-more-general-sets-using-lmi" class="nav-link" data-scroll-target="#more-general-sets-using-lmi">More general sets using LMI</a>
  <ul class="collapse">
  <li><a href="#affine-subspace" id="toc-affine-subspace" class="nav-link" data-scroll-target="#affine-subspace">Affine subspace</a></li>
  </ul></li>
  <li><a href="#continuity-conditions" id="toc-continuity-conditions" class="nav-link" data-scroll-target="#continuity-conditions">Continuity conditions</a></li>
  </ul>
<div class="toc-actions"><ul><li><a href="https://github.com/hurak/hys/issues/new" class="toc-action"><i class="bi bi-github"></i>Report an issue</a></li></ul></div></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./stability_recap.html">8. Stability</a></li><li class="breadcrumb-item"><a href="./stability_via_multiple_lyapunov_function.html">Stability via multiple Lyapunov functions</a></li></ol></nav>
<div class="quarto-title">
<h1 class="title">Stability via multiple Lyapunov functions</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<p>We start with an example in which we show it can happen that even if the hybrid (switched) system is stable, there is no common quadratic Lyapunov function.</p>
<div id="exm-no-cqlf" class="theorem example">
<p><span class="theorem-title"><strong>Example 1 (No common quadratic Lyapunov function can be found)</strong></span> We consider a switched system with two modes, linear models of which are parameterized by the matrices <span class="math inline">\mathbf A_1</span> and <span class="math inline">\mathbf A_2</span>:</p>
<div id="2" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>A₁ <span class="op">=</span> [<span class="op">-</span><span class="fl">0.1</span> <span class="op">-</span><span class="fl">1</span>; <span class="fl">2</span> <span class="op">-</span><span class="fl">0.1</span>]</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>A₂ <span class="op">=</span> [<span class="op">-</span><span class="fl">0.1</span> <span class="op">-</span><span class="fl">2</span>; <span class="fl">1</span> <span class="op">-</span><span class="fl">0.1</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Switching curve is given by <span class="math inline">x_1=0</span>, that is, the vertical axis. State portrait is in <a href="#fig-no-cqlf" class="quarto-xref">Fig.&nbsp;1</a>.</p>
<div id="cell-fig-no-cqlf" class="cell" data-execution_count="1">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="fu">f₁</span>(x) <span class="op">=</span> A₁<span class="op">*</span>x</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="fu">f₂</span>(x) <span class="op">=</span> A₂<span class="op">*</span>x</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a><span class="fu">f</span>(x) <span class="op">=</span> x[<span class="fl">1</span>] <span class="op">&lt;=</span> <span class="fl">0.0</span> ? <span class="fu">f₁</span>(x) <span class="op">:</span> <span class="fu">f₂</span>(x)</span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a><span class="im">using</span> <span class="bu">CairoMakie</span></span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>fig <span class="op">=</span> <span class="fu">Figure</span>(size <span class="op">=</span> (<span class="fl">800</span>, <span class="fl">800</span>),fontsize<span class="op">=</span><span class="fl">20</span>)</span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a>ax <span class="op">=</span> <span class="fu">Axis</span>(fig[<span class="fl">1</span>, <span class="fl">1</span>], xlabel <span class="op">=</span> <span class="st">"x₁"</span>, ylabel <span class="op">=</span> <span class="st">"x₂"</span>)</span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a><span class="fu">streamplot!</span>(ax,(x₁,x₂)<span class="fu">-&gt;Point2f</span>(<span class="fu">f</span>([x₁,x₂])), <span class="op">-</span><span class="fl">2.0</span><span class="op">..</span><span class="fl">2.0</span>, <span class="op">-</span><span class="fl">2.0</span><span class="op">..</span><span class="fl">2.0</span>, colormap <span class="op">=</span> <span class="op">:</span>magma)</span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a><span class="fu">vlines!</span>(ax,<span class="fl">0.0</span>,ymin<span class="op">=-</span><span class="fl">2.0</span>,ymax<span class="op">=</span><span class="fl">2.0</span>, color <span class="op">=</span> <span class="op">:</span>red, linewidth<span class="op">=</span><span class="fl">3</span>)</span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a>fig</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="1">
<div id="fig-no-cqlf" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-no-cqlf-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="stability_via_multiple_lyapunov_function_files/figure-html/fig-no-cqlf-output-1.svg" class="img-fluid figure-img">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-no-cqlf-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;1: State portrait for the switched system with no common quadratic Lyapunov function
</figcaption>
</figure>
</div>
</div>
</div>
<p>The equilibrium (the origin) of this switched system appears stable.</p>
<p>The individual systems are stable, which we can immediately see by computing the eigenvalues of the matrices <span class="math inline">A_1</span> and <span class="math inline">A_2</span>:</p>
<div id="6" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="im">using</span> <span class="bu">LinearAlgebra</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="fu">eigvals</span>(A₁), <span class="fu">eigvals</span>(A₂)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="1">
<pre><code>(ComplexF64[-0.1 - 1.4142135623730951im, -0.1 + 1.4142135623730951im], ComplexF64[-0.1 - 1.4142135623730951im, -0.1 + 1.4142135623730951im])</code></pre>
</div>
</div>
<p>We now try to find a common quadratic Lyapunov function for both subsystems. We will formulate the problem as an LMI feasibility problem.</p>
<div id="8" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="im">using</span> <span class="bu">Convex</span>, <span class="bu">SCS</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>X <span class="op">=</span> <span class="fu">Semidefinite</span>(<span class="fl">2</span>)</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>constraint₁ <span class="op">=</span> A₁<span class="ch">'*X + X*A₁ ⪯ -Matrix{Float64}(I, 2, 2)</span></span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>constraint₂ <span class="op">=</span> A₂<span class="ch">'*X + X*A₂ ⪯ -Matrix{Float64}(I, 2, 2)</span></span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>constraints <span class="op">=</span> [constraint₁, constraint₂]</span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>problem <span class="op">=</span> <span class="fu">satisfy</span>(constraints)</span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a><span class="fu">solve!</span>(problem,SCS.Optimizer,silent<span class="op">=</span><span class="cn">true</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Precompiling Convex...
   2573.1 ms  ✓ Convex
  1 dependency successfully precompiled in 3 seconds. 65 already precompiled.
Precompiling SCS...
   1320.7 ms  ✓ SCS
  1 dependency successfully precompiled in 1 seconds. 66 already precompiled.</code></pre>
</div>
<div class="cell-output cell-output-display" data-execution_count="1">
<pre><code>Problem statistics
  problem is DCP         : true
  number of variables    : 1 (4 scalar elements)
  number of constraints  : 3 (12 scalar elements)
  number of coefficients : 24
  number of atoms        : 10

Solution summary
  termination status : INFEASIBLE
  primal status      : INFEASIBLE_POINT
  dual status        : INFEASIBILITY_CERTIFICATE

Expression graph
  satisfy
   └─ nothing
  subject to
   ├─ PSD constraint (convex)
   │  └─ + (affine; real)
   │     ├─ 2×2 Matrix{Float64}
   │     └─ Convex.NegateAtom (affine; real)
   │        └─ …
   ├─ PSD constraint (convex)
   │  └─ + (affine; real)
   │     ├─ 2×2 Matrix{Float64}
   │     └─ Convex.NegateAtom (affine; real)
   │        └─ …
   ├─ PSD constraint (convex)
   │  └─ 2×2 real variable (id: 170…837)
   ⋮</code></pre>
</div>
</div>
<p>The solver does not find a solution. Well, perhaps trying another solver or two would make our conclusion more robust (<code>MosekTools</code> is another recommendable alternative to <code>SCS</code>). But we are now be tempted to conclude that there is no common quadratic Lyapunov function for both subsystems.</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Dual LMI problem confirms the infeasibility of the primal one
</div>
</div>
<div class="callout-body-container callout-body">
<p>It is possible to formulate a dual LMI problem. Its feasibility certifies infeasibility of the primal one. Namely, the problem is, if there are matrices <span class="math inline">\mathbf R_1\succ 0</span> and <span class="math inline">\mathbf R_2\succ 0</span> such that the following LMI holds: <span class="math display">
\mathbf R_1\mathbf A_1^\top+\mathbf A_1\mathbf R_1 + \mathbf R_2\mathbf A_2^\top+\mathbf A_2\mathbf R_2 \prec 0.
</span></p>
</div>
</div>
<p>The conclusion about the imposibility to find a single quadratic Lyapunov function for both subsystems is also suppported by plotting the invariant sets for the two subsystems. First, we need to compute Lyapunov functions for the two subsystems.</p>
<div id="10" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>X₁ <span class="op">=</span> <span class="fu">Semidefinite</span>(<span class="fl">2</span>)</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>constraint₁ <span class="op">=</span> A₁<span class="ch">'*X₁ + X₁*A₁ ⪯ -Matrix{Float64}(I, 2, 2)</span></span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>problem₁ <span class="op">=</span> <span class="fu">satisfy</span>(constraint₁)</span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a><span class="fu">solve!</span>(problem₁,SCS.Optimizer,silent<span class="op">=</span><span class="cn">true</span>)</span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>X₁.value</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="1">
<pre><code>2×2 Matrix{Float64}:
 423.71     12.5739
  12.5739  212.123</code></pre>
</div>
</div>
<div id="12" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>X₂ <span class="op">=</span> <span class="fu">Semidefinite</span>(<span class="fl">2</span>)</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>constraint₂ <span class="op">=</span> A₂<span class="ch">'*X₂ + X₂*A₂ ⪯ -Matrix{Float64}(I, 2, 2)</span></span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>problem₂ <span class="op">=</span> <span class="fu">satisfy</span>(constraint₂)</span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a><span class="fu">solve!</span>(problem₂,SCS.Optimizer,silent<span class="op">=</span><span class="cn">true</span>)</span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a>X₂.value</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="1">
<pre><code>2×2 Matrix{Float64}:
 212.123   -12.5739
 -12.5739  423.71</code></pre>
</div>
</div>
<p>Generally, a Lyapunov function has the property that its sublevel set <span class="math inline">\{\bm x \mid V(\bm x) \leq \alpha\}</span> is <em>forward (also positive) invariant</em>. We plot invariant sets corresponding to some particular value for both subsystems superposed on the state portrait in <a href="#fig-no-cqlf-with-lyapunov-invariant-sets" class="quarto-xref">Fig.&nbsp;2</a>.</p>
<div id="cell-fig-no-cqlf-with-lyapunov-invariant-sets" class="cell" data-execution_count="1">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>x1s <span class="op">=</span> <span class="fu">LinRange</span>(<span class="op">-</span><span class="fl">2</span>, <span class="fl">2</span>, <span class="fl">100</span>)</span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>x2s <span class="op">=</span> <span class="fu">LinRange</span>(<span class="op">-</span><span class="fl">2</span>, <span class="fl">2</span>, <span class="fl">100</span>)</span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a><span class="fu">V₁</span>(x) <span class="op">=</span> x<span class="op">'*</span>X₁.value<span class="op">*</span>x</span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a><span class="fu">V₂</span>(x) <span class="op">=</span> x<span class="op">'*</span>X₂.value<span class="op">*</span>x</span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a>V1s <span class="op">=</span> [<span class="fu">V₁</span>([x₁,x₂]) for x₁ <span class="kw">in</span> x1s, x₂ <span class="kw">in</span> x2s]</span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a>V2s <span class="op">=</span> [<span class="fu">V₂</span>([x₁,x₂]) for x₁ <span class="kw">in</span> x1s, x₂ <span class="kw">in</span> x2s]</span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a><span class="fu">contour!</span>(x1s, x2s, V1s, levels<span class="op">=</span>[<span class="fl">300.0</span>], linewidth<span class="op">=</span><span class="fl">3</span>, color<span class="op">=:</span>blue)</span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a><span class="fu">contour!</span>(x1s, x2s, V2s, levels<span class="op">=</span>[<span class="fl">300.0</span>], linewidth<span class="op">=</span><span class="fl">3</span>, color<span class="op">=:</span>green)</span>
<span id="cb12-9"><a href="#cb12-9" aria-hidden="true" tabindex="-1"></a>fig</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="1">
<div id="fig-no-cqlf-with-lyapunov-invariant-sets" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-no-cqlf-with-lyapunov-invariant-sets-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="stability_via_multiple_lyapunov_function_files/figure-html/fig-no-cqlf-with-lyapunov-invariant-sets-output-1.svg" class="img-fluid figure-img">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-no-cqlf-with-lyapunov-invariant-sets-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;2: Invariant ellipses for the two subsystems superposed on the state portrait
</figcaption>
</figure>
</div>
</div>
</div>
<p>We can see in <a href="#fig-no-cqlf-with-lyapunov-invariant-sets" class="quarto-xref">Fig.&nbsp;2</a> that none of the two ellipses works as an invariant set for the switched system – a state trajectory entering the set leaves it afterwards. No way to to come up with a single ellipse (hence a single quadratic Lyapunov function) that would work here.</p>
</div>
<p>Good, we have seen in the example that it is not always possible to find a common quadratic Lyapunov function for a switched system, even it it is stable. We need to expand the set of functions in which we search for a Lyapunov function. We have proposed one way to do it in the previouse chapter wherein we considered higher degree polynomials on which we imposed the nonnegativity constraint through in the form of SOS constraint. Here we are going to consider another approach. We are goint to stitch together several <em>Lyapunov-like</em> functions, each of which is a Lyapunov function only on some subset of the state space (that is why we call them just Lyapunov-like and not Lyapunov). This approach is sometimes called the <em>Multiple Lyapunov Function</em> (MLF) approach, or <em>Piecewise Lyapunov Function</em> approach.</p>
<section id="multiple-lyapunov-function-mlf-approach-to-analysis-of-stability" class="level2">
<h2 class="anchored" data-anchor-id="multiple-lyapunov-function-mlf-approach-to-analysis-of-stability">Multiple Lyapunov Function (MLF) approach to analysis of stability</h2>
<p>Instead of just a single <em>common Lyapunov function</em> <span class="math inline">V(\bm x)</span>, we are now going to consider several Lyapunov-like functions <span class="math inline">V_i(\bm x),\; i=1,\ldots,r,</span> that qualify as Lyapunov function only on some subsets of the state space <span class="math inline">\Omega_i</span>. And we “stitch” them together to form a piecewise Lyapunov function <span class="math inline">V(\bm x)</span>: <span class="math display">
V(x) =
\begin{cases}
V_1(\bm x) &amp; \text{if } \bm x\in \Omega_1, \\
\vdots\\
V_r(\bm x) &amp; \text{if } \bm x\in \Omega_r.
\end{cases}
</span></p>
</section>
<section id="s-procedure" class="level2">
<h2 class="anchored" data-anchor-id="s-procedure">S-procedure</h2>
<p>In order to restrict the requirement of positive definiteness of the Lyapunov function to some region in the state space, and similarly for the regurement of negative definiteness of its time derivative, we need to introduce the the <em>S-procedure</em>. This is a result about solvability of two or more quadratic inequalities, not necessarily convex ones (for convex problems we have nonlinear Farkas’ lemma). Origins of this result can be found in the control theory (analysis of stability of nonlinear systems, hence the S letter) with the first rigorous result provided by Yakubovich in 1970s.</p>
<p>It gives conditions under which (satisfaction of) one quadratic inequality follows from (satisfaction of) another one (or more). Namely, it gives a condition under which the following implication holds:</p>
<p><span class="math display">\boxed
{\text{Quadratic inequality \#1 satisfied by some}\; \bm x \Rightarrow \text{Quadratic inequality \#0 satisfied by the same}\; \bm x.}
</span></p>
<p>In other words, it gives a condition under which the solution set of the inequality #1 denoted as <span class="math inline">\mathcal X_1</span> is included in the solution set <span class="math inline">\mathcal X_0</span> of the inequality #0.</p>
<section id="s-procedure-with-nonstrict-inequalities" class="level3">
<h3 class="anchored" data-anchor-id="s-procedure-with-nonstrict-inequalities">S-procedure with nonstrict inequalities</h3>
<p>Consider the general quadratic functions <span class="math display">F_i(\bm x) = \bm x^\top \mathbf A_i \bm x + 2\mathbf b_i^\top \bm x + c_i, \; i=0,\ldots, p.</span></p>
<p>The question is: under which conditions it holds that <span class="math inline">F_0(\bm x) \geq 0</span> for all <span class="math inline">\bm x</span> satisfying <span class="math inline">F_i(\bm x)\geq 0,\; i=1,\ldots,p</span> ?</p>
<p>In other words, we are looking for conditions under which the implication <span class="math display">
F_i(\bm x) \geq 0,\; i=1,\ldots,p \quad \Rightarrow \quad F_0(\bm x) \geq 0
</span><br>
holds.</p>
<p>In the simplest (yet relevant) case <span class="math inline">p=1</span> we search for conditions under which <span class="math inline">F_0(\bm x) \geq 0</span> for all <span class="math inline">\bm x</span> satisfying <span class="math inline">F_1(\bm x)\geq 0</span>, that is, conditions under which the implication <span class="math display">
F_1(\bm x) \geq 0 \quad \Rightarrow \quad F_0(\bm x) \geq 0
</span><br>
holds.</p>
</section>
<section id="sufficient-conditions" class="level3">
<h3 class="anchored" data-anchor-id="sufficient-conditions">Sufficient conditions</h3>
<p>The existence of <span class="math inline">\alpha_i\geq 0,\; i=1,\ldots,p</span> such that <span class="math display">
F_0(\bm x)-\sum_{i=1}^p \alpha_i F_i(\bm x) \geq 0
</span> is sufficient for the original implication to hold. Generally, it is not necessary; the condition is conservative.</p>
<p>It can be formulated as an LMI <span class="math display">
\begin{bmatrix}
\mathbf A_0 &amp; \mathbf b_0 \\
\mathbf b_0^\top &amp; c_0
\end{bmatrix} -
\sum_{i=1}^p
\alpha_i
\begin{bmatrix}
\mathbf A_i &amp; \mathbf b_i \\
\mathbf b_i^\top &amp; c_i
\end{bmatrix}
\succeq 0
</span><br>
where <span class="math inline">\alpha_i \geq 0,\; i=1,\ldots,p</span>.</p>
</section>
<section id="sufficient-and-also-necessary" class="level3">
<h3 class="anchored" data-anchor-id="sufficient-and-also-necessary">Sufficient and also necessary</h3>
<p>It is nontrivial that for <span class="math inline">p=1</span> it is also necessary, provided that there is some <span class="math inline">\bm x_0</span> such that <span class="math inline">F_1(\bm x_0)&gt;0</span>. Then we have the following equivalence between the two constraints: <span class="math display">
\begin{aligned}
F_0(\bm x) &amp;\geq 0 \; \forall \bm x \;\mathrm{satisfying}\; F_1(\bm x)\geq 0 \\
&amp;\Longleftrightarrow \\
F_0(\bm x)-\alpha F_1(\bm x) &amp;\geq 0,\;\text{for some}\; \alpha\in\mathbb{R}, \; \alpha\geq 0,
\end{aligned}
</span><br>
which again can be formulated as an LMI, namely<br>
<span class="math display">
\begin{bmatrix}
\mathbf A_0 &amp; \mathbf b_0 \\
\mathbf b_0^\top &amp; c_0
\end{bmatrix} - \alpha
\begin{bmatrix}
\mathbf A_1 &amp; \mathbf b_1 \\
\mathbf b_1^\top &amp; c_1
\end{bmatrix}
\succeq 0,\quad \alpha\geq 0.
</span></p>
</section>
<section id="more-on-s-procedure" class="level3">
<h3 class="anchored" data-anchor-id="more-on-s-procedure">More on S-procedure</h3>
<p>There are several variants</p>
<ul>
<li>strict, nonstrict or mixed inequalities,</li>
<li>just two or more,</li>
<li>some of the constraints can be equations.</li>
</ul>
</section>
</section>
<section id="piecewise-quadratic-lyapunov-function" class="level2">
<h2 class="anchored" data-anchor-id="piecewise-quadratic-lyapunov-function">Piecewise quadratic Lyapunov function</h2>
<p>We now restrict ourselves to quadratic Lyapunov-like functions, that is, quadratic functions <span class="math inline">V_i(\bm x) = \bm x^\top \mathbf P_i \bm x</span> that qualify as Lyapunov functions only on respective subsets <span class="math inline">\Omega_i\sub \mathbb R^n</span>:</p>
<p><span class="math display">
V_i(\bm x) = \bm x^\top \mathbf P_i \bm x &gt; 0\quad \forall \;\bm x\in \Omega_i,
</span></p>
<p><span class="math display">
\dot V_i(\bm x) = \bm x^\top \left( \mathbf A_i^\top \mathbf P_i + \mathbf P_i \mathbf A_i \right) \bm x &lt; 0\quad \forall \;\bm x\in \Omega_i.
</span></p>
</section>
<section id="using-comparison-functions-and-nonstrict-inequalities" class="level2">
<h2 class="anchored" data-anchor-id="using-comparison-functions-and-nonstrict-inequalities">Using comparison functions and nonstrict inequalities</h2>
<p>We can use our good old comparison functions to formulate the conditions of positive definiteness and negative definiteness. <span class="math display">
\alpha_1 \bm x^\top \mathbf I \bm x \leq \bm x^\top \mathbf P_i \bm x \leq \alpha_2 \bm x^\top \mathbf I \bm x \quad \forall \;\bm x\in \Omega_i,
</span></p>
<p><span class="math display">
\bm x^\top \left( \mathbf A_i^\top \mathbf P_i + \mathbf P_i \mathbf A_i \right) \bm x \leq  -\alpha_3 \bm x^\top \mathbf I \bm x\quad \forall \;\bm x\in \Omega_i.
</span></p>
<p>The difference now is that these conditions are only reuired to hold on some state regions, some subsets of the state space. It is now time to discuss how to characterize those regions.</p>
</section>
<section id="characterization-of-subsets-of-state-space-using-lmi" class="level2">
<h2 class="anchored" data-anchor-id="characterization-of-subsets-of-state-space-using-lmi">Characterization of subsets of state space using LMI</h2>
<p>Some subsets <span class="math inline">\Omega_i\sub \mathbb R^n</span> characterized using linear and quadratic inequalities can be formulated within the LMI framework as <span class="math display">
\bm x^\top \mathbf Q_i \bm x \geq 0.
</span></p>
<p>In particular, centered ellipsoids and cones.</p>
<p>For example,<br>
<span class="math display">
\begin{aligned}
\Omega_i &amp;= \{\bm x \in \mathbb R^n \mid (\mathbf c^\top \bm x \geq 0 \land \mathbf d^\top \bm x \geq 0) \\
&amp; \qquad \qquad \qquad \lor (\mathbf c^\top \bm x \leq 0 \land \mathbf d^\top \bm x \leq 0)\}.
\end{aligned}
</span></p>
<p>This constraint can be reformulated as <span class="math display">
(\mathbf c^\top \bm x) (\mathbf d^\top \bm x) \geq 0,
</span><br>
which can be reformatted to <span class="math display">
\bm x^\top \mathbf c \mathbf d^\top \bm x \geq 0,
</span><br>
which can further be symmetrized to <span class="math display">
\bm x^\top \left(\frac{\mathbf c \mathbf d^\top + \mathbf d \mathbf c^\top}{2}\right) \bm x \geq 0.
</span></p>
<p>More general sets (general polyhedra, noncentered ellipsoids) can also be modelled using LMI too… We are going to have a look at them, but first we hurry to show how to combine the subset characterization and Lyapunov-ness using the S-procedure.</p>
</section>
<section id="combining-the-subset-characterization-and-lyapunov-ness-using-the-s-procedure" class="level2">
<h2 class="anchored" data-anchor-id="combining-the-subset-characterization-and-lyapunov-ness-using-the-s-procedure">Combining the subset characterization and Lyapunov-ness using the S-procedure</h2>
<p>We want to learn if the the following hold <span class="math display">
\alpha_i \bm x^\top \mathbf I \bm x \leq \bm x^\top \mathbf P_i \bm x,
</span></p>
<p><span class="math display">
\bm x^\top \left( \mathbf A_i^\top \mathbf P_i + \mathbf P_i \mathbf A_i \right) \bm x \leq  -\gamma_i \bm x^\top \mathbf I \bm x,
</span></p>
<p>but not for all <span class="math inline">\bm x</span>, but only for <span class="math inline">\bm x\in \Omega_i</span>, that is, all <span class="math inline">\bm x</span> satisfying <span class="math inline">\bm x^\top \mathbf Q_i \bm x \geq 0</span>. But this is now a perfect opportunity for application of the S-procedure:</p>
<p><span class="math display">
\mathbf P_i - \alpha_i \mathbf I - \mu_i \mathbf Q_i \succeq 0,\quad \mu_i \geq 0,\; \alpha_i &gt; 0,
</span></p>
<p><span class="math display">
\mathbf A_i^\top \mathbf P_i + \mathbf P_i \mathbf A_i + \gamma_i \mathbf I + \xi_i \mathbf Q \preceq 0,\quad \mu_i \geq 0,\; \gamma_i &gt; 0.
</span></p>
</section>
<section id="more-general-sets-using-lmi" class="level2">
<h2 class="anchored" data-anchor-id="more-general-sets-using-lmi">More general sets using LMI</h2>
<p>How can we model more general sets using LMI?</p>
<p>The inequality <span class="math display">
\bm x^\top \mathbf Q \bm x + 2\mathbf r^\top \bm x + s \geq 0,
</span></p>
<p>can be reformulated as <span class="math display">
\begin{bmatrix}
\bm x^\top &amp; 1
\end{bmatrix}
\underbrace{
\begin{bmatrix}
\mathbf Q &amp; \mathbf r \\ \mathbf r^\top &amp; s
\end{bmatrix}}_{\bar{\mathbf{Q}}}
\underbrace{
\begin{bmatrix}
\bm x \\ 1
\end{bmatrix}}_{\bar{\bm x}}
\geq 0,
</span></p>
<p>that is, as an LMI <span class="math display">
\begin{bmatrix}
\mathbf Q &amp; \mathbf r \\ \mathbf r^\top &amp; s
\end{bmatrix}
\succeq 0.
</span></p>
<section id="affine-subspace" class="level3">
<h3 class="anchored" data-anchor-id="affine-subspace">Affine subspace</h3>
<p><span class="math display">
\mathbf c^\top \bm x + d \geq 0,
</span></p>
<p><span class="math display">
\begin{bmatrix}
\bm x^\top &amp; 1
\end{bmatrix}
\begin{bmatrix}
\mathbf 0 &amp; \mathbf c \\ \mathbf c^\top &amp; 2d
\end{bmatrix}
\begin{bmatrix}
\bm x \\ 1
\end{bmatrix}
\geq 0,
</span></p>
<p><span class="math display">
\begin{bmatrix}
\mathbf 0 &amp; \mathbf c \\ \mathbf c^\top &amp; 2d
\end{bmatrix}
\succeq 0.
</span></p>
<p>But then the Lyapunov-like functions and system matrices must also be extended <span class="math display">
V(\bm x) =
\begin{bmatrix}
\bm x^\top &amp; 1
\end{bmatrix}
\underbrace{
\begin{bmatrix}
\mathbf P &amp; \mathbf P_{12} \\ \mathbf P_{12} &amp; P_{22}
\end{bmatrix}}_{\bar{\mathbf P}}
\begin{bmatrix}
\bm x \\ 1
\end{bmatrix},
</span></p>
<p><span class="math display">
\bar{\mathbf{A}} =
\begin{bmatrix}
\mathbf A &amp; \mathbf 0 \\ \mathbf 0 &amp; 0
\end{bmatrix}.
</span></p>
</section>
</section>
<section id="continuity-conditions" class="level2">
<h2 class="anchored" data-anchor-id="continuity-conditions">Continuity conditions</h2>
<p>The boundary between the regions <span class="math inline">\Omega_i</span> and <span class="math inline">\Omega_j</span> described by <span class="math display">
\Omega_{ij} = \{\bm x \in \mathbb R^n \mid \mathbf F_{ij} \bm z + \mathbf{l}_{ij}\},
</span> where <span class="math inline">\bm z\in \mathbb R^p</span>, <span class="math inline">\mathbf F_{ij}\in \mathbb R^{n\times p}</span>, and <span class="math inline">\mathbf l_{ij}\in \mathbb R^{n}</span>.</p>
<p>The continuity conditions are <span class="math display">
V_i(\bm x) = V_j(\bm x) \quad \forall \bm x \in \Omega_{ij},
</span> which can be reformulated as <span class="math display">
\begin{aligned}
&amp;\left(\mathbf F_{ij} \bm z + \mathbf{l}_{ij}\right)^\top \mathbf P_i \left(\mathbf F_{ij} \bm z + \mathbf{l}_{ij}\right) \\
&amp; \qquad + 2\left(\mathbf F_{ij} \bm z + \mathbf{l}_{ij}\right)^\top \bm q_i + r_i \\
&amp;= \left(\mathbf F_{ij} \bm z + \mathbf{l}_{ij}\right)^\top \mathbf P_j \left(\mathbf F_{ij} \bm z + \mathbf{l}_{ij}\right) \\
&amp; \qquad + 2\left(\mathbf F_{ij} \bm z + \mathbf{l}_{ij}\right)^\top \bm q_j + r_j
\end{aligned}.
</span></p>
<p>Collecting the terms with equal powers of <span class="math inline">\bm z</span>. <span class="math display">
\begin{aligned}
\mathbf F_{ij}^\top (\mathbf P_1 - \mathbf P_2) \mathbf F_{ij} &amp;= 0, \\
\mathbf F_{ij}^\top (\mathbf P_1 - \mathbf P_2) \mathbf l_{ij} + (\mathbf q_1-\mathbf q_2)  &amp;= 0, \\
\mathbf l_{ij}^\top (\mathbf P_1 - \mathbf P_2)\mathbf l_{ij} + 2\mathbf l_{ij}^\top (\mathbf q_1-\mathbf q_2) + r_1-r_2 &amp;= 0.
\end{aligned}
</span></p>


</section>

<a onclick="window.scrollTo(0, 0); return false;" role="button" id="quarto-back-to-top"><i class="bi bi-arrow-up"></i> Back to top</a></main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp("https:\/\/hurak\.github\.io\/hys\/");
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./stability_via_common_lyapunov_function.html" class="pagination-link" aria-label="Stability via common Lyapunov function">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text">Stability via common Lyapunov function</span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./stability_software.html" class="pagination-link" aria-label="Software">
        <span class="nav-page-text">Software</span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">
      &nbsp;
    </div>   
    <div class="nav-footer-center">
<p>Copyright 2024, Zdeněk Hurák</p>
<div class="toc-actions d-sm-block d-md-none"><ul><li><a href="https://github.com/hurak/hys/issues/new" class="toc-action"><i class="bi bi-github"></i>Report an issue</a></li></ul></div></div>
    <div class="nav-footer-right">
      &nbsp;
    </div>
  </div>
</footer>




</body></html>